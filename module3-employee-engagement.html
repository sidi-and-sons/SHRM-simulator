<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Module 3: Employee Engagement | SHRM-CP Simulation</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>Employee Engagement</h1>
            <span class="week-badge">Week 12</span>
            <p>Foster a motivated, committed workforce through strategic engagement initiatives</p>
        </header>

        <div id="startScreen" class="start-screen">
            <h2>Welcome to the Employee Engagement Simulation</h2>
            <div class="instructions">
                <h3>Instructions</h3>
                <ul>
                    <li>You will receive 8 inbox items requiring your response</li>
                    <li>Each item presents a realistic HR scenario</li>
                    <li>Select the best response from the options provided</li>
                    <li>You will receive immediate feedback after each selection</li>
                    <li>Each item is worth 12.5 points (100 points total)</li>
                    <li>You cannot change your answers once submitted</li>
                    <li>A summary will be provided at the end of the module</li>
                </ul>
            </div>
            <button class="btn btn-primary" onclick="startSimulation()">Begin Simulation</button>
        </div>

        <div id="progressContainer" class="progress-container hidden">
            <div class="progress-header">
                <span>Progress</span>
                <span id="progressText">0 of 8 completed</span>
            </div>
            <div class="progress-bar">
                <div id="progressFill" class="progress-fill"></div>
            </div>
        </div>

        <div id="questionsContainer" class="hidden"></div>

        <div id="summaryContainer" class="summary-container">
            <div class="summary-header">
                <h2>Module Complete!</h2>
                <div class="final-score" id="finalScore">0</div>
                <div class="score-label">out of 100 points</div>
                <div id="gradeBadge" class="grade-badge"></div>
            </div>
            <h3 style="margin: 20px 0; color: #4fc3f7;">Your Responses</h3>
            <div id="summaryItems" class="summary-items"></div>
            <div class="nav-buttons" style="margin-top: 30px;">
                <button class="btn btn-secondary" onclick="window.print()">Print Results</button>
                <a href="index.html" class="btn btn-primary" style="text-decoration: none;">Return to Menu</a>
            </div>
        </div>
    </div>

    <script>
        let currentQuestion = 1;
        let totalQuestions = 8;
        let answers = {};
        let totalScore = 0;
        let shuffledOptions = {};

        const questions = [
            {
                id: 1,
                from: "Catherine Yang, VP of Human Resources",
                subject: "Engagement Survey Results Are In",
                time: "Today, 8:45 AM",
                body: `Hi Team,<br><br>
                    Our annual engagement survey results just came back. Overall engagement dropped from 72% to 58%. The biggest drops were in "I feel valued by leadership" (down 20 points) and "I see a future for myself here" (down 18 points). The CEO is concerned and wants an action plan. How should we approach this?<br><br>
                    Catherine`,
                options: [
                    { id: 'A', text: "Conduct focus groups to understand the root causes behind the scores, share results transparently with employees, develop targeted action plans with leadership input, and establish regular pulse surveys to measure improvement.", score: 100, rating: 'excellent' },
                    { id: 'B', text: "Analyze the data by department and demographics to identify patterns, meet with managers to discuss findings, and create department-specific action plans with measurable goals.", score: 80, rating: 'good' },
                    { id: 'C', text: "Present the results to leadership with recommendations for improving recognition programs and career development opportunities based on the low-scoring areas.", score: 55, rating: 'acceptable' },
                    { id: 'D', text: "Implement company-wide initiatives to address the low-scoring areas, such as new recognition programs and leadership training, as quickly as possible.", score: 30, rating: 'poor' },
                    { id: 'E', text: "Remind employees that survey participation is voluntary and the results may not represent everyone's experience, then schedule the next survey for a better time.", score: 10, rating: 'problematic' }
                ],
                feedback: {
                    A: "Excellent comprehensive approach. Focus groups uncover root causes beyond numbers, transparency builds trust, targeted action plans address specific issues, and pulse surveys enable agile response. This demonstrates strategic engagement management.",
                    B: "Good analytical approach that identifies patterns and involves managers. Department-specific plans recognize that engagement drivers vary. However, adding employee voice through qualitative research would strengthen the approach.",
                    C: "Acceptable but jumps to solutions before fully diagnosing problems. Recommendations without deeper understanding of causes may miss the mark. Employee input should inform the action plan.",
                    D: "This implements solutions without understanding causes. Quick implementation may address symptoms rather than root issues. The lack of employee involvement in developing solutions often leads to ineffective programs.",
                    E: "Problematic dismissal of significant feedback. Declining to act on survey results damages trust and future participation. Employees shared concerns that deserve investigation and response."
                }
            },
            {
                id: 2,
                from: "Marcus Johnson, Engineering Manager",
                subject: "Remote Team Feels Disconnected",
                time: "Today, 9:30 AM",
                body: `Hey,<br><br>
                    Since we went fully remote, my team feels isolated. They've mentioned missing casual conversations and feeling "out of the loop." I notice less collaboration and some people seem to just log hours without engaging. Team meetings feel transactional. Any ideas to rebuild team connection virtually?<br><br>
                    Marcus`,
                options: [
                    { id: 'A', text: "Suggest implementing a mix of virtual social events, dedicated non-work chat channels, regular one-on-ones, cross-functional project pairing, and occasional in-person gatherings to create multiple touchpoints for connection.", score: 100, rating: 'excellent' },
                    { id: 'B', text: "Recommend structured virtual coffee chats, team building activities during meetings, and creating informal Slack channels for non-work discussions to foster organic relationship building.", score: 80, rating: 'good' },
                    { id: 'C', text: "Suggest starting team meetings with personal check-ins and scheduling monthly virtual happy hours to recreate some of the social aspects of office work.", score: 55, rating: 'acceptable' },
                    { id: 'D', text: "Recommend requiring cameras on during all meetings so people feel more present and connected with their colleagues.", score: 30, rating: 'poor' },
                    { id: 'E', text: "Suggest that remote work naturally has less social connection, and the focus should be on productivity metrics rather than trying to recreate office culture.", score: 10, rating: 'problematic' }
                ],
                feedback: {
                    A: "Excellent multi-pronged approach addressing both structured and organic connection opportunities. The combination of virtual and occasional in-person interactions, plus work and non-work touchpoints, creates a comprehensive connection strategy.",
                    B: "Good variety of recommendations that address different types of connection needs. Structured and informal elements together create more natural relationship building opportunities.",
                    C: "Acceptable starting point but may not be enough to counter feelings of isolation. Monthly events are too infrequent, and meeting check-ins can feel performative without other touchpoints.",
                    D: "This mandates behavior rather than creating genuine connection. Forced camera requirements can cause resentment and don't address the deeper isolation issues. Autonomy matters in remote work.",
                    E: "Problematic dismissal of social needs. Research shows remote employee engagement and retention depend significantly on connection and belonging. Ignoring this guarantees the problems will worsen."
                }
            },
            {
                id: 3,
                from: "Diana Ross, Customer Success Director",
                subject: "Employee Burnout Concerns",
                time: "Today, 10:15 AM",
                body: `Hi HR,<br><br>
                    My team has been working 60+ hour weeks for the past 3 months due to a major client implementation. They're exhausted, and I'm seeing signs of burnout - missed deadlines, short tempers, increased sick days. I've asked for more resources but was told the budget doesn't allow it. How can I support my team without additional headcount?<br><br>
                    Diana`,
                options: [
                    { id: 'A', text: "Help Diana prioritize and defer non-critical work, implement temporary schedule flexibility, recognize individual contributions, advocate for compensatory time off, and build a business case showing burnout costs vs. resource investment.", score: 100, rating: 'excellent' },
                    { id: 'B', text: "Recommend immediate workload analysis to identify what can be delayed, ensure employees take their PTO, recognize extra efforts publicly, and schedule regular wellness check-ins.", score: 80, rating: 'good' },
                    { id: 'C', text: "Suggest Diana implement mandatory lunch breaks and earlier end times, encourage use of EAP resources, and plan a team celebration once the project completes.", score: 55, rating: 'acceptable' },
                    { id: 'D', text: "Remind Diana that high-intensity periods are normal in business and focus on keeping morale up until the project is complete.", score: 30, rating: 'poor' },
                    { id: 'E', text: "Advise Diana that employee resilience is key and those who can't handle the pressure may not be the right fit for the demands of the role.", score: 10, rating: 'problematic' }
                ],
                feedback: {
                    A: "Excellent holistic approach addressing immediate relief and systemic issues. Workload reduction, recognition, and building a business case for resources shows strategic thinking. Advocacy for compensatory time demonstrates employee-centric support.",
                    B: "Good immediate actions that address visible symptoms of burnout. Workload analysis, enforced PTO, and wellness focus are appropriate responses, though building a case for systemic change would strengthen it.",
                    C: "Acceptable interventions but may be insufficient for severe burnout. Mandatory breaks are helpful but don't reduce workload. Post-project celebration is too late if people burn out first.",
                    D: "This normalizes unsustainable practices. Three months of 60-hour weeks is not a temporary spike - it's a systemic issue. Dismissing employee wellbeing erodes trust and increases turnover.",
                    E: "Problematic response that blames employees for systemic workload issues. This approach will accelerate turnover, damage employer brand, and create legal risks if burnout leads to health issues."
                }
            },
            {
                id: 4,
                from: "James Wright, Regional Sales Manager",
                subject: "New Recognition Program Ideas",
                time: "Today, 11:00 AM",
                body: `Hey,<br><br>
                    I want to implement a recognition program for my sales team. I'm thinking monthly MVP awards with gift cards. But I'm worried it might demotivate people who never win, and some reps have easier territories. Also, my top performers say they don't care about public recognition - they want money. What approach would work best?<br><br>
                    James`,
                options: [
                    { id: 'A', text: "Design a multi-faceted program with peer-to-peer recognition, individual improvement awards, team achievements, and choices between public acknowledgment or private rewards to address different motivations and fairness concerns.", score: 100, rating: 'excellent' },
                    { id: 'B', text: "Recommend recognition categories that go beyond sales numbers (customer feedback, mentoring others, biggest improvement) and let winners choose between public recognition or bonus compensation.", score: 80, rating: 'good' },
                    { id: 'C', text: "Suggest focusing on spot bonuses tied to specific achievements rather than monthly awards, removing the competitive element while still recognizing contributions.", score: 55, rating: 'acceptable' },
                    { id: 'D', text: "Recommend keeping recognition simple with quarterly bonuses based on sales targets, since money is what salespeople are most motivated by.", score: 30, rating: 'poor' },
                    { id: 'E', text: "Advise against formal recognition programs entirely since they often create more resentment than motivation, especially in competitive sales environments.", score: 10, rating: 'problematic' }
                ],
                feedback: {
                    A: "Excellent inclusive design that addresses fairness, diverse motivations, and different recognition preferences. Peer recognition broadens opportunities, improvement awards reduce favoritism concerns, and choice respects individual preferences.",
                    B: "Good approach that expands recognition beyond pure metrics and addresses the preference for monetary vs. public rewards. Multiple categories create more winners and reduce competitive negativity.",
                    C: "Acceptable simplified approach but misses the opportunity for peer and team recognition. Spot bonuses are transactional and may not build the engagement that comes from acknowledgment and appreciation.",
                    D: "This oversimplifies motivation. While salespeople value compensation, recognition research shows money alone doesn't sustain engagement. This approach also doesn't address fairness concerns about territory differences.",
                    E: "Problematic avoidance of recognition's well-documented benefits. Properly designed programs increase engagement without creating resentment. Abandoning recognition cedes a valuable engagement lever."
                }
            },
            {
                id: 5,
                from: "Priya Sharma, Learning & Development Manager",
                subject: "Low Participation in Development Programs",
                time: "Today, 1:30 PM",
                body: `Hi,<br><br>
                    We invested significantly in a new learning platform with hundreds of courses, but participation is only 12%. Employees say they don't have time to take courses during work hours, and managers aren't encouraging it. How do we increase engagement with professional development when everyone is so busy?<br><br>
                    Priya`,
                options: [
                    { id: 'A', text: "Work with leadership to allocate dedicated learning time, tie development to career progression, include manager goals for team development, create learning paths aligned with role needs, and measure completion in performance discussions.", score: 100, rating: 'excellent' },
                    { id: 'B', text: "Recommend making learning part of the work expectation by blocking calendar time, connecting courses to promotion criteria, and holding managers accountable for team development.", score: 80, rating: 'good' },
                    { id: 'C', text: "Suggest curating a smaller selection of high-impact courses rather than overwhelming options, and promote completion through gamification and visible leaderboards.", score: 55, rating: 'acceptable' },
                    { id: 'D', text: "Recommend making certain courses mandatory for compliance and role requirements to ensure baseline participation.", score: 30, rating: 'poor' },
                    { id: 'E', text: "Suggest that employees who truly want to develop will make time on their own, and those who don't participate may not be growth-oriented.", score: 10, rating: 'problematic' }
                ],
                feedback: {
                    A: "Excellent systemic approach that addresses root causes - time, incentives, manager support, and relevance. Connecting learning to career outcomes and making it a managed expectation creates sustainable participation.",
                    B: "Good focus on structural enablers of learning. Blocking time and manager accountability address the stated barriers. Promotion connection creates meaningful incentive for participation.",
                    C: "Acceptable incremental improvement but doesn't address the core barrier of time and manager support. Gamification can help but won't overcome structural obstacles to participation.",
                    D: "This creates compliance without engagement. Mandatory training breeds resentment and checkbox completion. True development requires intrinsic motivation that comes from seeing career value.",
                    E: "Problematic blame-the-employee response. The issue is structural - employees lack time and manager support. Attributing low participation to employee character ignores organizational responsibility."
                }
            },
            {
                id: 6,
                from: "Robert Chen, Facilities Director",
                subject: "Return to Office Resistance",
                time: "Today, 2:15 PM",
                body: `Hello,<br><br>
                    Leadership mandated a return to office 3 days per week starting next month. I'm getting angry emails from employees who moved during the pandemic or have caregiving responsibilities. Several high performers have said they'll quit rather than return. We need people back for collaboration, but I don't want to lose talent. Thoughts?<br><br>
                    Robert`,
                options: [
                    { id: 'A', text: "Recommend a phased approach with flexibility for individual circumstances, create an exception process for hardship cases, communicate the business rationale clearly, and redesign office days to maximize the collaboration that justifies in-person work.", score: 100, rating: 'excellent' },
                    { id: 'B', text: "Suggest piloting the policy with willing teams first, gathering feedback, addressing concerns through an accommodation process, and ensuring in-office days have purposeful collaborative activities.", score: 80, rating: 'good' },
                    { id: 'C', text: "Recommend clear communication about the policy reasons and timeline, while establishing an HR process for reviewing individual accommodation requests.", score: 55, rating: 'acceptable' },
                    { id: 'D', text: "Advise holding firm on the mandate since exceptions will create resentment among those who comply, while accepting that some turnover is inevitable with policy changes.", score: 30, rating: 'poor' },
                    { id: 'E', text: "Suggest that employees who threaten to quit are being manipulative, and the company shouldn't let individual preferences override business decisions.", score: 10, rating: 'problematic' }
                ],
                feedback: {
                    A: "Excellent balanced approach respecting both business needs and employee concerns. Phased implementation allows adjustment, exception processes address hardships, and purposeful in-office design justifies the policy.",
                    B: "Good piloting approach that gathers data before full rollout. Feedback loops and accommodation processes show respect for employee concerns while moving toward business objectives.",
                    C: "Acceptable communication focus, but waiting until policy launch to address individual concerns may be too late. Proactive outreach and flexibility options would prevent avoidable exits.",
                    D: "This prioritizes consistency over talent retention. Losing high performers has real costs. Some flexibility in implementation usually generates better outcomes than rigid enforcement.",
                    E: "Problematic dismissal of legitimate employee concerns. People made major life decisions during the pandemic. Labeling concerned employees as manipulative damages trust and accelerates departures."
                }
            },
            {
                id: 7,
                from: "Michelle Torres, Department Director",
                subject: "Manager Undermining Engagement Efforts",
                time: "Today, 3:00 PM",
                body: `Hi,<br><br>
                    One of my managers, Kevin, has a team with the lowest engagement scores. He dismisses surveys as "HR fluff," openly mocks team-building activities, and tells his team that "work is work, not a party." His team produces results, but they're miserable and turnover is twice the company average. How do I address this?<br><br>
                    Michelle`,
                options: [
                    { id: 'A', text: "Help Michelle present Kevin with data connecting his team's low engagement to turnover costs and productivity impacts. Include leadership behaviors in his performance expectations and provide coaching on effective management practices.", score: 100, rating: 'excellent' },
                    { id: 'B', text: "Recommend that Michelle have a direct conversation with Kevin about how his behaviors affect team engagement and retention, set clear expectations for improvement, and offer leadership development resources.", score: 80, rating: 'good' },
                    { id: 'C', text: "Suggest Michelle include engagement metrics in Kevin's performance goals and make clear that his compensation will be partially tied to team retention and satisfaction.", score: 55, rating: 'acceptable' },
                    { id: 'D', text: "Advise accepting that Kevin's management style works for some situations, and focus on ensuring his team has access to engagement resources even if he doesn't promote them.", score: 30, rating: 'poor' },
                    { id: 'E', text: "Suggest that since Kevin's team delivers results, his approach shouldn't be challenged. Different managers have different styles, and not everyone needs to embrace engagement initiatives.", score: 10, rating: 'problematic' }
                ],
                feedback: {
                    A: "Excellent data-driven approach that speaks to business impact. Connecting engagement to turnover costs makes it a performance issue, not just HR preference. Coaching provides support for behavior change.",
                    B: "Good direct approach that sets clear expectations and offers development resources. Making the conversation about management effectiveness rather than personality makes it actionable.",
                    C: "Acceptable accountability approach but may feel punitive without the coaching component. Metrics without development support may not actually change Kevin's behavior or beliefs.",
                    D: "This enables a manager who actively undermines company culture. Kevin's results come at the cost of unsustainable turnover. Short-term production doesn't offset long-term talent pipeline damage.",
                    E: "Problematic acceptance of destructive management. The double turnover rate is a quantifiable problem. Managers who openly mock company initiatives create permission for others to disengage."
                }
            },
            {
                id: 8,
                from: "Angela Hayes, Culture & Engagement Lead",
                subject: "Employee Resource Groups Need Support",
                time: "Today, 4:00 PM",
                body: `Hi,<br><br>
                    Our Employee Resource Groups (ERGs) are struggling. Leaders are burning out because it's all volunteer work on top of their jobs. Membership is declining because events happen during work hours but managers won't release people. Executive sponsors rarely attend. How do we revitalize these important groups?<br><br>
                    Angela`,
                options: [
                    { id: 'A', text: "Propose allocating dedicated time for ERG leadership, creating policy requiring managers to release employees for ERG activities, holding executive sponsors accountable through regular engagement, and connecting ERG involvement to professional development.", score: 100, rating: 'excellent' },
                    { id: 'B', text: "Recommend formalizing ERG leader roles with protected time, providing small budgets for activities, setting clear expectations for executive sponsors, and communicating the business value of ERGs to managers.", score: 80, rating: 'good' },
                    { id: 'C', text: "Suggest reducing the scope of ERG activities to be more manageable, rotating leadership to prevent burnout, and scheduling events during lunch hours to minimize work conflicts.", score: 55, rating: 'acceptable' },
                    { id: 'D', text: "Recommend consolidating multiple ERGs into fewer groups to reduce the leadership burden and focus resources on the most active communities.", score: 30, rating: 'poor' },
                    { id: 'E', text: "Accept that ERGs naturally have cycles of activity and decline. If membership is dropping, perhaps the groups have served their purpose and resources could be redirected.", score: 10, rating: 'problematic' }
                ],
                feedback: {
                    A: "Excellent structural approach that treats ERG leadership as valued work. Protected time, manager requirements, and executive accountability address the root causes of burnout and declining participation.",
                    B: "Good formalization approach that legitimizes ERG work. Budget allocation, protected time, and executive expectations create institutional support that volunteer-only models lack.",
                    C: "Acceptable coping strategies but don't address root issues. Reducing scope may help short-term but signals declining organizational commitment. Lunch meetings still require release from work.",
                    D: "This may eliminate groups that serve distinct communities with different needs. Consolidation can marginalize smaller identity groups and reduce the belonging benefits ERGs provide.",
                    E: "Problematic abandonment of DEI infrastructure. ERGs are declining because of structural barriers, not lack of interest. Redirecting resources signals deprioritization of inclusion efforts."
                }
            }
        ];

        const itemTitles = [
            "Engagement Survey Results",
            "Remote Team Disconnection",
            "Employee Burnout",
            "Recognition Program Design",
            "Low L&D Participation",
            "Return to Office Resistance",
            "Manager Undermining Engagement",
            "ERG Support Needs"
        ];

        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        function renderQuestion(question, index) {
            const shuffledOpts = shuffleArray(question.options);
            shuffledOptions[question.id] = shuffledOpts;
            const isLast = index === questions.length - 1;
            const nextAction = isLast ? 'showSummary()' : `nextQuestion(${question.id + 1})`;
            const nextBtnText = isLast ? 'View Results' : 'Next Item';

            let optionsHtml = '';
            shuffledOpts.forEach((opt, idx) => {
                const letter = String.fromCharCode(65 + idx);
                optionsHtml += `<button class="response-option" onclick="selectAnswer(${question.id}, '${opt.id}', ${opt.score}, '${opt.rating}')">${letter}) ${opt.text}</button>`;
            });

            return `
                <div id="question${question.id}" class="question-container${index === 0 ? ' active' : ''}">
                    <div class="inbox-item">
                        <span class="item-number">Item ${question.id} of 8</span>
                        <div class="email-header">
                            <div class="email-icon">ðŸ“§</div>
                            <div class="email-meta">
                                <div class="email-from">${question.from}</div>
                                <div class="email-subject">${question.subject}</div>
                                <div class="email-time">${question.time}</div>
                            </div>
                        </div>
                        <div class="email-body">${question.body}</div>
                        <div class="response-options">${optionsHtml}</div>
                        <div id="feedback${question.id}" class="feedback-panel">
                            <div class="feedback-header">
                                <span class="feedback-label">Feedback</span>
                                <span class="feedback-score"></span>
                            </div>
                            <div class="feedback-text"></div>
                        </div>
                    </div>
                    <div class="nav-buttons">
                        <button id="nextBtn${question.id}" class="btn btn-primary" onclick="${nextAction}" disabled>${nextBtnText}</button>
                    </div>
                </div>`;
        }

        function renderQuestions() {
            const container = document.getElementById('questionsContainer');
            container.innerHTML = questions.map((q, i) => renderQuestion(q, i)).join('');
        }

        function startSimulation() {
            renderQuestions();
            document.getElementById('startScreen').classList.add('hidden');
            document.getElementById('progressContainer').classList.remove('hidden');
            document.getElementById('questionsContainer').classList.remove('hidden');
        }

        function selectAnswer(questionNum, answerId, score, rating) {
            if (answers[questionNum]) return;
            const question = questions.find(q => q.id === questionNum);
            answers[questionNum] = { answer: answerId, score: score, rating: rating, feedback: question.feedback[answerId] };
            totalScore += (score / 100) * 12.5;

            const options = document.querySelectorAll(`#question${questionNum} .response-option`);
            options.forEach(opt => { opt.style.pointerEvents = 'none'; opt.style.opacity = '0.7'; });
            event.target.classList.add(rating);
            event.target.style.opacity = '1';

            const feedbackPanel = document.getElementById(`feedback${questionNum}`);
            feedbackPanel.className = `feedback-panel show ${rating}`;
            feedbackPanel.querySelector('.feedback-score').textContent = `${score}% (${rating.charAt(0).toUpperCase() + rating.slice(1)})`;
            feedbackPanel.querySelector('.feedback-text').textContent = question.feedback[answerId];
            document.getElementById(`nextBtn${questionNum}`).disabled = false;
            updateProgress();
        }

        function updateProgress() {
            const completed = Object.keys(answers).length;
            document.getElementById('progressFill').style.width = `${(completed / totalQuestions) * 100}%`;
            document.getElementById('progressText').textContent = `${completed} of ${totalQuestions} completed`;
        }

        function nextQuestion(nextNum) {
            document.getElementById(`question${nextNum - 1}`).classList.remove('active');
            document.getElementById(`question${nextNum}`).classList.add('active');
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function showSummary() {
            document.getElementById('questionsContainer').classList.add('hidden');
            document.getElementById('progressContainer').classList.add('hidden');
            document.getElementById('summaryContainer').classList.add('show');

            const finalScore = Math.round(totalScore);
            document.getElementById('finalScore').textContent = finalScore;

            let grade, gradeClass;
            if (finalScore >= 90) { grade = 'A'; gradeClass = 'grade-a'; }
            else if (finalScore >= 80) { grade = 'B'; gradeClass = 'grade-b'; }
            else if (finalScore >= 70) { grade = 'C'; gradeClass = 'grade-c'; }
            else if (finalScore >= 60) { grade = 'D'; gradeClass = 'grade-d'; }
            else { grade = 'F'; gradeClass = 'grade-f'; }

            document.getElementById('gradeBadge').textContent = `Grade: ${grade}`;
            document.getElementById('gradeBadge').className = `grade-badge ${gradeClass}`;

            const summaryItems = document.getElementById('summaryItems');
            for (let i = 1; i <= totalQuestions; i++) {
                const answer = answers[i];
                const itemDiv = document.createElement('div');
                itemDiv.className = 'summary-item';
                itemDiv.innerHTML = `
                    <div class="summary-item-header">
                        <span class="summary-item-title">Item ${i}: ${itemTitles[i-1]}</span>
                        <span class="summary-item-score ${answer.rating}">${answer.score}%</span>
                    </div>
                    <div class="summary-item-response">Your answer: Option ${answer.answer}</div>
                    <div class="summary-item-feedback">${answer.feedback}</div>`;
                summaryItems.appendChild(itemDiv);
            }
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
    </script>
</body>
</html>
